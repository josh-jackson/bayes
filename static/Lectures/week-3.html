<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Week 3</title>
    <meta charset="utf-8" />
    <meta name="author" content="Josh Jackson" />
    <script src="week-3_files/header-attrs-2.3/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">





&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 30px;
    padding: 1em 4em 1em 4em;
}

.small .remark-code { 
  font-size: 80% !important;
}
.tiny .remark-code {
  font-size: 65% !important;
}
&lt;/style&gt;


## Goals for this week
Go deeper into basic linear models to become comfortable with standard regressions

Again, we will walk through an example or two to help us along

---




```r
data &lt;- "https://raw.githubusercontent.com/josh-jackson/bayes/master/week3.csv"

week3 &lt;- read.csv(data) %&gt;% 
  select(-ID, -SES)

week3
```

```
##          happy   friends mood.group     health
## 1   1.86099188  4.176523          0  4.5640566
## 2   0.21912408  3.759815          0 10.6597953
## 3   3.54842009  9.497278          1 14.8440198
## 4   3.28845198  4.963567          2  4.9978947
## 5   1.24927862  1.335338          0  6.9382498
## 6   1.50027416  4.870580          1  3.7980809
## 7   2.92433313  6.215720          1  8.0270505
## 8   1.66733572  5.815054          2  9.9626835
## 9   3.11005982  7.683533          1  9.2059870
## 10  2.72914277  2.943047          1  8.4923032
## 11  4.39897865  4.032585          1 12.1208403
## 12  3.53437370  6.205217          1 12.4331327
## 13  3.65986297  9.261576          0  8.5555276
## 14  4.65817214  6.763594          1 11.3686611
## 15  2.27560297  4.851453          2 11.5694196
## 16  2.95159865  6.240207          0  5.4711721
## 17  4.10218047  6.973998          2  8.4519734
## 18  1.12059240  5.036057          2  4.5667653
## 19  2.05833415  7.740862          1 11.7526501
## 20  0.19305280  7.759608          1 10.8226415
## 21  3.50355773  8.749197          2  9.8105699
## 22  4.78418731  4.756792          1  9.1277596
## 23  1.06676001  6.561631          1  6.5318595
## 24  3.30530750  3.175915          1 10.0237012
## 25  4.61659441 11.228795          0 11.7420222
## 26  3.97859881  3.957705          0  7.2737794
## 27  0.35606277  7.813100          1  8.3704646
## 28  1.94703884  5.468486          2 12.0994488
## 29  2.03225608  5.250680          1  8.1637595
## 30  3.29677539  4.551704          1  9.5443353
## 31  2.11673573  6.521937          1  9.9945814
## 32  1.60492223  7.823219          1 12.8755751
## 33  0.98865367  4.883255          2  4.6909984
## 34  0.81585047  2.253814          2  8.9651992
## 35  2.61655537  5.785562          2  9.1560838
## 36  4.56739326  4.336673          0  5.4488116
## 37  1.03386359  6.607520          1 10.6606187
## 38  4.07141508  6.115068          1  7.2597276
## 39  0.10083599  3.711709          0  7.2679814
## 40  4.62402207  3.625557          1  8.6482218
## 41  2.17480873  6.198989          1  5.1070680
## 42  2.21027342  9.453457          0  9.1593706
## 43  3.80344728  8.985688          0  7.4339090
## 44  1.66480650  4.398902          2  9.0928075
## 45  1.97178576  3.670528          1  5.7313981
## 46  1.16647141  5.246911          0  5.3507789
## 47  0.35803829  4.411584          0  6.6060095
## 48  4.56691743  2.898346          0  2.6521072
## 49  3.85846787  4.868912          1  9.8621705
## 50  0.53768320  7.167517          1  7.0237089
## 51  0.39606125  2.217562          2  9.0207288
## 52  2.16944724  6.561022          0  3.4553030
## 53  3.39887123  5.997563          2  7.8377788
## 54  3.67178120  1.874784          2  8.6336387
## 55  2.26255437  7.119586          0 11.5985175
## 56  3.91892858  4.148590          0  5.2031040
## 57  3.39917769  1.847190          1  8.7228487
## 58  2.59351826  8.145468          0 11.9085631
## 59  3.45402877  4.329517          1  9.7333939
## 60  2.94137825 10.324863          0 11.4859977
## 61  4.07294834  4.787144          1 12.5438459
## 62  4.05022473  4.609969          1 14.2980607
## 63  3.04967951  8.279238          2 12.1461175
## 64  4.96704822  6.431736          0 10.7821185
## 65  4.21620271  6.172160          0  8.6486218
## 66  3.57751702  6.128896          0  8.3563001
## 67  0.09540594  6.771640          2  9.6833816
## 68  1.52540126  3.844246          1 11.6272520
## 69  4.41473992  5.363370          1  9.2779219
## 70  4.70673408  6.610789          1 10.3634385
## 71  1.17209005  6.380328          2  4.2802691
## 72  4.68332914  5.253042          0 13.0007468
## 73  2.83350988  5.942500          0 10.1358263
## 74  4.21395202  3.962200          1 11.1562617
## 75  4.10650590  6.360323          1  8.5981369
## 76  1.39986427  9.929426          2 14.2260172
## 77  0.23650569  5.856582          0  4.3491779
## 78  1.12470314  5.811277          0  8.8571921
## 79  3.36546324  6.502768          1  9.7491380
## 80  4.79465429  7.123532          2 14.0765217
## 81  3.42629986  1.933902          2 10.0404019
## 82  3.87901492  2.988022          1  7.6101350
## 83  3.87919245  3.052267          1  6.6400716
## 84  4.91397400  7.339483          0  6.1480330
## 85  0.05094323  8.305993          1  8.6992735
## 86  4.76292926  8.465961          1 10.9683070
## 87  1.61467931  6.698720          0 10.0373042
## 88  2.14002672  1.257154          0  9.4460877
## 89  0.67248346  5.999466          1  5.2918581
## 90  0.09164156  3.679235          1  7.7655590
## 91  3.28249751  7.978303          1  6.3372499
## 92  4.57366668  8.871538          1 16.5109072
## 93  3.57649926  6.245307          1  3.3817140
## 94  0.91475723  3.505397          1  6.1956627
## 95  1.20034086  4.489978          2  6.2224089
## 96  4.18224540  4.200512          1  7.7401760
## 97  1.92936728  8.733855          0  7.8723238
## 98  1.16286902  5.670159          2  7.9856544
## 99  0.34460320  7.566552          1  8.8051692
## 100 0.31112264  8.245090          0 10.4014561
## 101 0.62509687  7.125878          1  8.7113863
## 102 0.11663346  5.159979          1  8.2499019
## 103 1.95930638  4.705842          1  6.6148716
## 104 4.29799283  6.150367          1 10.5030389
## 105 3.59167261  9.891258          1 12.1594813
## 106 1.69697514  4.104596          2  0.7066834
## 107 0.40610714 10.638080          1  4.4338189
## 108 0.18617163  5.980704          1  3.0972955
## 109 3.86544394  3.717763          0  9.7471429
## 110 4.97541129  5.423782          1  9.8573015
## 111 0.73293216  5.734030          1 11.8521843
## 112 0.19922433  7.690971          1  5.8622057
## 113 2.82838948  6.739700          2 12.4677636
## 114 4.44292936  5.478127          0 12.2742321
## 115 4.35360831  5.753884          0  5.5666706
## 116 4.90874716  6.339427          1  7.2931286
## 117 4.39873448  7.578514          0  5.5900820
## 118 2.55200868  9.937304          1  7.9032039
## 119 1.67187673  4.689934          0 11.3572772
## 120 3.06667657  6.842705          2  5.9220865
## 121 1.98754107  7.124963          2 11.6018189
## 122 0.69967554  4.787041          1  2.4838889
## 123 0.39548398  8.782787          0  9.4450330
## 124 2.75110764  5.254739          1  5.9642775
## 125 1.30322599  6.656962          0  7.5035014
## 126 4.04764926  7.798535          2 11.2762001
## 127 2.72384837  8.493368          1 13.7008502
## 128 2.37246631  9.073152          0  6.8080581
## 129 3.31854011  6.922207          1  9.6155361
## 130 0.46088128  6.629294          0  5.7457813
## 131 3.25280462  1.379784          1  6.5731088
## 132 1.84239543  9.349398          1 10.8295921
## 133 1.22894949  8.168235          2  3.7612117
## 134 1.49301856  8.113731          0  9.4065741
## 135 2.79592354  6.344285          2 14.2740437
## 136 2.40177790  6.216542          2 10.1128493
## 137 2.38506903  6.401344          2 12.1275318
## 138 4.67767311  4.378284          0  4.8474773
## 139 2.35088812  8.547497          2  8.5433200
## 140 3.39098321  8.220029          1  4.9781351
## 141 4.67232602  5.438038          0  3.4850653
## 142 1.36999726  5.239475          1  9.4172956
## 143 4.73688548  5.607044          0  4.0916033
## 144 1.56651031  8.808961          0 10.2134654
## 145 4.37788633  5.328912          1 10.7817952
## 146 0.83679943  5.755841          0  3.9134767
## 147 2.34535844  4.309261          0  4.1947270
## 148 3.26114870  5.213310          0  4.5979312
## 149 0.17230356  8.239418          1  6.7310373
## 150 2.17726158  5.316205          0  7.7475791
## 151 0.74882179  6.152522          0  7.0976454
## 152 2.29452922  8.025877          0 12.6225560
## 153 3.09430787  3.590427          1  9.9609391
## 154 4.78146670  4.334285          0 11.0856280
## 155 0.50317101  8.461995          2  8.0226430
## 156 1.13857693  7.139152          1 10.1686641
## 157 2.77506881  7.776015          2  8.8173456
## 158 3.85514822 10.987422          1  9.0744789
## 159 2.39834542  7.423034          0  8.9792152
## 160 4.40518654  5.621692          2  6.3223738
## 161 4.83998839  4.824513          2  8.6954419
## 162 3.45249020  5.820828          0  9.0318686
## 163 4.33430550  7.831526          0  9.5766306
## 164 2.80141790  7.110392          0  9.6103342
## 165 1.52272068  4.976290          2  5.9412234
## 166 4.99643776  6.782215          1 13.1183355
## 167 1.46630822  2.831823          2  9.8071108
## 168 4.51685685  5.514937          2  9.9470844
## 169 0.20955528  5.732482          1  5.2052072
## 170 2.99262897  7.927739          2  9.8307414
## 171 3.40545098  1.673944          1  6.9373695
## 172 4.91519878  6.897450          1  9.1871176
## 173 2.51074571  5.406566          0  3.1179416
## 174 3.71420533  2.430032          0  9.4137709
## 175 4.55589083  5.358929          0  8.9082071
## 176 4.94190076  6.763785          2 12.3765379
## 177 3.82748409  3.726258          0  4.6645082
## 178 4.10263621  8.176609          0 10.0199091
## 179 4.69867281  5.024115          1  8.3312329
## 180 3.35813491  5.992240          1  7.1345108
## 181 4.53746158  4.527805          2  9.0434508
## 182 3.81145062  4.309662          1  2.9235078
## 183 2.43166442  5.913238          1  5.9675206
## 184 1.25104343  3.911480          2 10.9791082
## 185 1.79522359  6.340832          2  8.2827677
## 186 0.04296803  7.223363          1  7.5511441
## 187 1.17855788  5.719613          0  7.5014892
## 188 0.53117367  9.412720          0 10.8890809
## 189 3.05516987  6.772035          1  6.6605963
## 190 1.02348501  3.012060          1  7.0083721
## 191 1.07305212  4.489611          2  7.2772011
## 192 0.08245872  1.610812          1  9.7877898
## 193 1.64097183  7.661981          1  8.3123487
## 194 1.34797638  5.813819          2  9.4293247
## 195 4.56936203  5.510436          0  4.2547183
## 196 2.08935902  2.683754          1  7.5454356
## 197 3.45282825  4.584966          1  3.7862375
## 198 4.50006446  8.179837          0 13.4403083
## 199 1.03854465  6.469114          2 11.8725661
## 200 2.30516580  4.046544          0  9.5992624
```

---


```
## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2
```

![](week-3_files/figure-html/unnamed-chunk-3-1.png)&lt;!-- --&gt;
---

DV ~ Normal( `\(\mu_i\)` , `\(\sigma\)` )  [Likelihood]  #Note SD not var

`\(\mu_i\)` = `\(\beta_0\)` + `\(\beta_1\)` `\(x_i\)` [linear model]  #Note the = not the ~  

Priors (We'll revisit how we come up with these later)  
`\(\beta_0\)` ~ Normal(10, 4)  [prior for intercept]  
`\(\beta_1\)` ~ Normal(0, 5)  [prior for b1]  
`\(\sigma\)`  ~ HalfCauchy(0,1) [prior for sigma]  



---
## Prior Predictive


---
## Bayesian R2


---
## Rhat and other model components




---
## Categorical data



---
### dummy variables



---
## Factorial design









---
## Hypothesis function


---
## update function


---
## emmeans




---
## pp checks



---
## Robust regression
https://solomonkurz.netlify.app/post/robust-linear-regression-with-the-robust-student-s-t-distribution/

We are going to use a t-distribution as our likelihood. 


```r
b2 &lt;- 
  brm(family = student,
      y ~ 1 + x,
      prior = c(prior(normal(0, 10), class = Intercept),
                prior(normal(0, 10), class = b),
                prior(gamma(4, 1), class = nu),
                prior(cauchy(0, 1),  class = sigma)),
      data = data)
```

---
### gamma plot


---
### fixing nu


```r
b4 &lt;-
  brm(family = student,
      bf(y ~ 1 + x, nu = 4),
      prior = c(prior(normal(0, 100), class =Intercept),
                prior(normal(0, 10),  class = b),
                prior(cauchy(0, 1),   class = sigma)),
         data = o)
```




---
## Correlation preview

Introduce multivariate models




## For homework

Give model definition, ask to define likelihood, priors, etc. Then Ask how many parameters are in posterior distribution. 

Prior predictive simulations

visualizing different model effects


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
